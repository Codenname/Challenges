#!/usr/bin/env python3

import time, struct, sys
# import socket as so
import socket
import subprocess
from pwn import *
import json
import re
import threading


answers = {'Black Ops 2008: Itâ€™s The End Of The Cache As We Know It': '64K Should Be Good Enough For Anyone',
           'It is 2008. It is the end of the cache as we know it. Or... ':'64K Should Be Good Enough For Anyone',
           'The famous president Skroob luggage combination': '12345',
           'The scoring system determines the quality of the game': 'Caezar',
           'Level 1 questions make CISSPs turn red, Level 2 make SANS Fellows cry in frustration. We are talking of course of the CTF organized by..': 'ddtek',
           'Which American group recorded a song named Ooo?': '!!!',
           'What is the name of the legitbs 9-bit middle endian architecture?': 'clemency',
           'DNS guru, and the first person Dan called in 2008 to discuss its newly discovered DNS flaw.': 'paul vixie',
           'It was the first trivia question in the 2006 DEF CON quals. It all started like this: "Hack the ...."': 'planet',
           'Super-secure launching code for Nuclear silos during the cold war.': '00000000',
           'When David Lightman hacked into the school system to change his grade in Biology 2, the school password was.': 'pencil',
           'What was the first year in which OOO organized the defcon CTF?': '2018',
           'What is the most common meaning of the OOO abbreviation according to wikipedis': 'out of office',
           'In 1992, the Zero Wing videogame shocked the world with the phrase:': 'All your base are belong to us',
           'The name of the university from which he obtained his bachelor': 'Santa Clara University',
           'They took over the Defcon CTF organization in 2002, and defined the game as we all know and love today.': 'Ghetto Hackers',
           'He described a penicillin shot in the ass as  "the worst thing that has ever happened to me". He is the one and only.': 'Kevin Mitnick',
           'Smashing the Stack for Fun and Profit. We all know it by heart, right? But do you remember its last sentence?': 'Use the source d00d',
           'He once won a game of Connect Four in three moves, and inspired a Facebook master password': 'Chuck Norris',
           'We are obviously talking about Dan ...': 'Kaminsky',
           'In the defcon quals 2020, what was the highest ranked team that had three letters O in its name?': 'YOKARO-MON',
           "The name of the university from which he obtained his bachelor's degree.":'Santa Clara University',
           'What is the most common meaning of the OOO abbreviation according to wikipedia?':'out of office',
           'In this year, IDA Pro 5.0 introduced the first GUI.':'2006',
           'Level 1 questions make CISSPs turn red, Level 2 make SANS Fellows cry in frustration. We are talking of course of the CTF organized by...':'ddtek',
           'Default passwords for IBM 8225 systems': 'A52896nG93096a',
           'OOO is using a log-decay dynamic scoring formula in which the number of teams who solved a challenge is multiplied by which constant?':'0.08',
           'What was the first column in the first Jeopardy qualification board introduced by Kenshoto in 2006?':'Potent Pwnables',
           'Who (person) was the famous Defcon CTF organizer who said "The Scoring System determines the quality of the game"':'Caezar',
           'DNS guru, and the first person Dan called in 2008 to discuss its newly discovered DNS flaw. ':'paul vixie',
           'He described a penicillin shot in the ass as  "the worst thing that has ever happened to me". He is the one and only..':'Kevin Mitnick',
           'When David Lightman hacked into the school system to change his grade in Biology 2, the school password was..':'pencil',
           'Its three-letter acronym is used by astronomers to indicate double neutron stars': "domain name system",
           }

try:
    server = 'exploit-for-dummies.challenges.ooo'
    port = 5000
except IndexError:
    print("[+] Usage %s host" % sys.argv[0])
    sys.exit()

#
# questions_file = open("questions_answers.json", "r")
# questions = json.loads(questions_file.read())
# questions_file.close()

conn = remote(server,port)
try:
	conn.recvuntil(' ENTER ', drop=True)
	conn.send('\r\n')
	count=0
	while count < 25:
		#sleep(1.5)
		question = ''
		send_answer = ''
		conn.recvuntil(':\n', drop=True)
		question = conn.recvline().decode('latin-1').rstrip('\n')
		send_answer = (answers[question]+'\n')
		print(question)
		print(send_answer)
		conn.send(send_answer.encode())
		conn.recvuntil(':)', drop=True)
		conn.send('\r\n')
		count += 1

	# Say we wanna save
	conn.recvuntil('(yes/no)', drop=True)
	print ("\n[+] Got asked to save!")
	#srloop()

	conn.send('yes\n')

	# Save file selection
	conn.recvuntil('File Name:', drop=True)
	print("[+] Sending Filename")
	conn.send('questions.txt\n\n\n')
	conn.recvuntil("ENTER to continue>", drop=True)
	conn.send("\n")
	conn.interactive()
except:
    conn.close()